<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>KET Day 1 äº’åŠ¨å­¦ä¹  (å¯å¼€å…³ç¿»è¯‘ç‰ˆ)</title>
    <style>
        :root {
            --primary: #4a90e2;
            --secondary: #ecf0f1;
            --text-main: #2c3e50;
            --accent: #d35400;
            --success: #27ae60;
            --danger: #c0392b;
        }

        body {
            font-family: "Segoe UI", "Microsoft YaHei", sans-serif;
            background-color: #eef2f7;
            color: var(--text-main);
            margin: 0;
            padding: 20px;
            display: flex;
            justify-content: center;
            min-height: 90vh;
        }

        .app-container {
            width: 100%;
            max-width: 800px;
            background: white;
            border-radius: 16px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.08);
            display: flex;
            flex-direction: column;
            overflow: hidden;
            position: relative;
        }

        /* é¡¶éƒ¨ Header */
        header {
            background: var(--primary);
            color: white;
            padding: 20px;
            text-align: center;
        }
        h1 { margin: 0; font-size: 1.5rem; }
        .subtitle { font-size: 0.9rem; opacity: 0.9; margin-top: 5px; }

        /* å¯†ç é”æ  */
        .lock-bar {
            background: #fff3cd;
            padding: 12px;
            text-align: center;
            border-bottom: 1px solid #eee;
            transition: background 0.3s;
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 10px;
            min-height: 40px;
        }
        
        .lock-bar.unlocked {
            background: #d4edda;
            color: #155724;
        }

        .lock-input {
            padding: 6px; border: 1px solid #ccc; border-radius: 4px; width: 100px; text-align: center; font-size: 1rem;
        }

        .btn-unlock {
            background: #2c3e50; color: white; border: none; padding: 7px 15px; border-radius: 4px; cursor: pointer; font-weight: bold;
        }
        
        .btn-close {
            background: var(--danger); color: white; border: none; padding: 7px 15px; border-radius: 4px; cursor: pointer; font-weight: bold;
        }
        .btn-close:hover { background: #a93226; }

        /* æ§åˆ¶æ˜¾ç¤º/éšè—çš„åŒºåŸŸ */
        #inputArea { display: flex; align-items: center; gap: 10px; }
        #controlArea { display: none; align-items: center; gap: 15px; }

        /* å†…å®¹åŒºåŸŸ */
        .content-area {
            flex: 1;
            padding: 30px;
            background: #fdfdfd;
        }

        /* å•ä¸ªé¡µé¢ (é»˜è®¤éšè—) */
        .page-section {
            display: none;
            animation: fadeIn 0.4s ease;
        }
        .page-section.active {
            display: block;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .section-title {
            font-size: 1.4rem;
            color: var(--primary);
            border-bottom: 3px solid var(--secondary);
            padding-bottom: 10px;
            margin-bottom: 20px;
            font-weight: bold;
        }

        /* æ–‡ç« æ–‡æœ¬ */
        .passage-text {
            font-size: 1.25rem;
            line-height: 1.8;
            color: #34495e;
            white-space: pre-wrap;
            margin-bottom: 20px;
        }

        .vocab {
            color: var(--accent);
            font-weight: bold;
            background-color: #fff5e6;
            padding: 0 4px;
            border-radius: 4px;
        }

        /* ç¿»è¯‘å— (é»˜è®¤éšè—) */
        .translation-block {
            display: none;
            background: #f8f9fa;
            border-left: 5px solid var(--primary);
            padding: 15px;
            margin-top: 20px;
            color: #57606f;
            line-height: 1.6;
            border-radius: 0 8px 8px 0;
        }
        
        .app-container.show-translation .translation-block {
            display: block;
            animation: slideDown 0.3s;
        }

        @keyframes slideDown {
            from { opacity: 0; transform: translateY(-5px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* æ’­æ”¾æ§åˆ¶æŒ‰é’® */
        .audio-controls {
            margin-top: 25px;
            display: flex;
            gap: 15px;
            padding-top: 20px;
            border-top: 1px solid #eee;
        }

        .btn-audio {
            border: none; padding: 10px 20px; border-radius: 30px;
            cursor: pointer; font-weight: bold; font-size: 1rem;
            display: flex; align-items: center; gap: 8px; transition: transform 0.1s;
        }
        .btn-play { background: var(--success); color: white; }
        .btn-play:hover { background: #219150; transform: scale(1.05); }
        .btn-stop { background: var(--danger); color: white; }

        /* å¬åŠ›åˆ—è¡¨æ ·å¼ */
        .listen-item {
            background: white; border: 1px solid #eee; padding: 15px; border-radius: 8px;
            margin-bottom: 15px; display: flex; flex-direction: column;
        }
        .listen-top { display: flex; align-items: center; justify-content: space-between; }
        .listen-title { font-weight: bold; font-size: 1.1rem; }
        .btn-circle {
            width: 40px; height: 40px; border-radius: 50%; border: none;
            background: var(--primary); color: white; cursor: pointer; font-size: 18px;
        }
        .btn-circle.playing { background: var(--danger); }
        
        .script-text {
            margin-top: 10px; padding: 10px; background: #fffaf0;
            font-size: 0.95rem; border-radius: 6px; display: none;
        }
        .app-container.show-translation .script-text { display: block; }

        /* åº•éƒ¨å¯¼èˆªæ  */
        .nav-bar {
            background: #f1f2f6; padding: 15px 30px; display: flex;
            justify-content: space-between; align-items: center; border-top: 1px solid #ddd;
        }

        .btn-nav {
            background: white; border: 1px solid #ccc; padding: 8px 20px;
            border-radius: 6px; cursor: pointer; font-weight: bold; color: #555;
            transition: all 0.2s;
        }
        .btn-nav:hover { background: var(--primary); color: white; border-color: var(--primary); }
        .btn-nav:disabled { opacity: 0.5; cursor: not-allowed; background: #eee; }

        .page-indicator { font-weight: bold; color: #7f8c8d; }
        .speed-ctrl { display: flex; align-items: center; gap: 5px; font-size: 0.9rem; }
        select { padding: 5px; border-radius: 4px; }

    </style>
</head>
<body>

<div class="app-container" id="mainApp">
    <header>
        <h1>KET Day 1 å¬è¯»ç»ƒä¹ </h1>
        <div class="subtitle">People & Family (Grade 4)</div>
    </header>

    <div class="lock-bar" id="lockBar">
        
        <div id="inputArea">
            <span>ğŸ”’ ç¿»è¯‘é”: </span>
            <input type="password" id="pwd" class="lock-input" placeholder="">
            <button class="btn-unlock" onclick="unlock()">è§£é”</button>
        </div>

        <div id="controlArea">
            <span>âœ… ä¸­æ–‡ç¿»è¯‘å·²å¼€å¯</span>
            <button class="btn-close" onclick="lock()">ğŸ”’ å…³é—­/éšè—ç¿»è¯‘</button>
        </div>

    </div>

    <div class="content-area">

        <div class="page-section active" id="page1">
            <div class="section-title">Page 1: The Family Party (Reading)</div>
            
            <div class="passage-text" id="text1">Hello, my name is Sam. Today is Saturday. We have a big party at my house. There are many <span class="vocab">guests</span>.
Look at the woman in the red dress. She is my <span class="vocab">aunt</span>, Lisa. She is my dad's sister. The boy next to her is Mike. He is my <span class="vocab">cousin</span>. Mike is 15 years old. He is a <span class="vocab">teenager</span>. He likes playing basketball.
We are all happy. Every <span class="vocab">member</span> of the family is here today!</div>

            <div class="translation-block">
                <strong>[å‚è€ƒè¯‘æ–‡]ï¼š</strong><br>
                ä½ å¥½ï¼Œæˆ‘å«è¨å§†ã€‚ä»Šå¤©æ˜¯æ˜ŸæœŸå…­ã€‚æˆ‘å®¶æœ‰ä¸€ä¸ªç››å¤§çš„èšä¼šã€‚æœ‰å¾ˆå¤šå®¢äººã€‚<br>
                çœ‹é‚£ä½ç©¿çº¢è£™å­çš„å¥³å£«ã€‚å¥¹æ˜¯æˆ‘çš„é˜¿å§¨ä¸½èã€‚å¥¹æ˜¯æˆ‘çˆ¸çˆ¸çš„å§å§ã€‚å¥¹æ—è¾¹çš„ç”·å­©æ˜¯è¿ˆå…‹ã€‚ä»–æ˜¯æˆ‘çš„è¡¨å¼Ÿã€‚è¿ˆå…‹ä»Šå¹´15å²ã€‚ä»–æ˜¯ä¸ªé’å°‘å¹´ã€‚ä»–å–œæ¬¢æ‰“ç¯®çƒã€‚<br>
                æˆ‘ä»¬éƒ½å¾ˆå¼€å¿ƒã€‚ä»Šå¤©å®¶é‡Œçš„æ¯ä¸ªæˆå‘˜éƒ½åœ¨è¿™é‡Œï¼
            </div>

            <div class="audio-controls">
                <button class="btn-audio btn-play" onclick="playFullText('text1')">â–¶ æœ—è¯»å…¨æ–‡</button>
                <button class="btn-audio btn-stop" onclick="stopAudio()">â–  åœæ­¢</button>
            </div>
        </div>

        <div class="page-section" id="page2">
            <div class="section-title">Page 2: My Neighbors (Reading)</div>
            
            <div class="passage-text" id="text2">I live in a nice house. I have a very good <span class="vocab">neighbor</span>. His name is Mr. White. So his <span class="vocab">surname</span> is White.
Mr. White lives with Mrs. White. She is his <span class="vocab">wife</span>, and he is her <span class="vocab">husband</span>. They are very kind. They have no children living with them now. They are both <span class="vocab">adults</span>. They like gardening. I like playing with their dog.</div>

            <div class="translation-block">
                <strong>[å‚è€ƒè¯‘æ–‡]ï¼š</strong><br>
                æˆ‘ä½åœ¨ä¸€ä¸ªæ¼‚äº®çš„æˆ¿å­é‡Œã€‚æˆ‘æœ‰ä¸€ä¸ªéå¸¸å¥½çš„é‚»å±…ã€‚ä»–çš„åå­—å«æ€€ç‰¹å…ˆç”Ÿã€‚æ‰€ä»¥ä»–çš„å§“æ°æ˜¯æ€€ç‰¹ã€‚<br>
                æ€€ç‰¹å…ˆç”Ÿå’Œæ€€ç‰¹å¤ªå¤ªä½åœ¨ä¸€èµ·ã€‚å¥¹æ˜¯ä»–çš„å¦»å­ï¼Œä»–æ˜¯å¥¹çš„ä¸ˆå¤«ã€‚ä»–ä»¬éå¸¸å‹å–„ã€‚ä»–ä»¬ç°åœ¨æ²¡æœ‰å­©å­å’Œä»–ä»¬ä½åœ¨ä¸€èµ·ã€‚ä»–ä»¬éƒ½æ˜¯æˆå¹´äººã€‚ä»–ä»¬å–œæ¬¢å›­è‰ºã€‚æˆ‘å–œæ¬¢å’Œä»–ä»¬çš„ç‹—ä¸€èµ·ç©ã€‚
            </div>

            <div class="audio-controls">
                <button class="btn-audio btn-play" onclick="playFullText('text2')">â–¶ æœ—è¯»å…¨æ–‡</button>
                <button class="btn-audio btn-stop" onclick="stopAudio()">â–  åœæ­¢</button>
            </div>
        </div>

        <div class="page-section" id="page3">
            <div class="section-title">Page 3: Listening Practice</div>

            <div class="listen-item">
                <div class="listen-top">
                    <span class="listen-title">1. Colleague</span>
                    <button class="btn-circle listen-btn" onclick="playListen(1, this)">â–¶</button>
                </div>
                <div class="script-text">
                    åŸæ–‡: "This is Mr. Li. He works with my dad. He is my dad's <strong>colleague</strong>."<br>
                    <span style="color:#7f8c8d; font-size:0.9em;">[è¯‘]: è¿™æ˜¯æå…ˆç”Ÿã€‚ä»–å’Œçˆ¸çˆ¸ä¸€èµ·å·¥ä½œã€‚ä»–æ˜¯çˆ¸çˆ¸çš„åŒäº‹ã€‚</span>
                </div>
            </div>

            <div class="listen-item">
                <div class="listen-top">
                    <span class="listen-title">2. Surname</span>
                    <button class="btn-circle listen-btn" onclick="playListen(2, this)">â–¶</button>
                </div>
                <div class="script-text">
                    åŸæ–‡: "My name is Tom Brown. My <strong>surname</strong> is Brown."<br>
                    <span style="color:#7f8c8d; font-size:0.9em;">[è¯‘]: æˆ‘å«æ±¤å§†Â·å¸ƒæœ—ã€‚æˆ‘çš„å§“æ°æ˜¯å¸ƒæœ—ã€‚</span>
                </div>
            </div>

            <div class="listen-item">
                <div class="listen-top">
                    <span class="listen-title">3. Grandchild</span>
                    <button class="btn-circle listen-btn" onclick="playListen(3, this)">â–¶</button>
                </div>
                <div class="script-text">
                    åŸæ–‡: "My grandma loves me very much. I am her happy <strong>grandchild</strong>."<br>
                    <span style="color:#7f8c8d; font-size:0.9em;">[è¯‘]: æˆ‘å¥¶å¥¶éå¸¸çˆ±æˆ‘ã€‚æˆ‘æ˜¯å¥¹å¿«ä¹çš„å­™å­/å­™å¥³ã€‚</span>
                </div>
            </div>

            <div class="listen-item">
                <div class="listen-top">
                    <span class="listen-title">4. True or False</span>
                    <button class="btn-circle listen-btn" onclick="playListen(4, this)">â–¶</button>
                </div>
                <div class="script-text">
                    åŸæ–‡: "Look at this photo. This is not a child. This is an <strong>adult</strong>. He is working in the office."<br>
                    <span style="color:#7f8c8d; font-size:0.9em;">[è¯‘]: çœ‹è¿™å¼ ç…§ç‰‡ã€‚è¿™ä¸æ˜¯ä¸ªå­©å­ã€‚è¿™æ˜¯ä¸€ä¸ªæˆå¹´äººã€‚ä»–æ­£åœ¨åŠå…¬å®¤å·¥ä½œã€‚</span>
                </div>
            </div>

        </div>

    </div>

    <div class="nav-bar">
        <button class="btn-nav" id="btnPrev" onclick="changePage(-1)" disabled>â† ä¸Šä¸€é¡µ</button>
        
        <div class="center-controls">
            <span class="page-indicator" id="pageInd">Page 1 / 3</span>
            <span class="speed-ctrl">
                | è¯­é€Ÿ:
                <select id="rate">
                    <option value="0.7">0.7x</option>
                    <option value="0.9" selected>0.9x</option>
                    <option value="1.1">1.1x</option>
                </select>
            </span>
        </div>

        <button class="btn-nav" id="btnNext" onclick="changePage(1)">ä¸‹ä¸€é¡µ â†’</button>
    </div>
</div>

<script>
    // ================= çŠ¶æ€ç®¡ç† =================
    let currentPage = 1;
    const totalPages = 3;
    const pwd = "777";

    // ================= ç¿»é¡µé€»è¾‘ =================
    function changePage(step) {
        stopAudio();

        const nextPage = currentPage + step;
        if (nextPage < 1 || nextPage > totalPages) return;

        document.getElementById(`page${currentPage}`).classList.remove('active');
        currentPage = nextPage;
        document.getElementById(`page${currentPage}`).classList.add('active');

        document.getElementById('pageInd').innerText = `Page ${currentPage} / ${totalPages}`;
        document.getElementById('btnPrev').disabled = (currentPage === 1);
        document.getElementById('btnNext').disabled = (currentPage === totalPages);
    }

    // ================= å¯†ç  & å¼€å…³é€»è¾‘ =================
    function unlock() {
        const input = document.getElementById('pwd');
        const lockBar = document.getElementById('lockBar');
        const app = document.getElementById('mainApp');
        const inputArea = document.getElementById('inputArea');
        const controlArea = document.getElementById('controlArea');

        if (input.value === pwd) {
            // å¼€å¯ç¿»è¯‘
            app.classList.add('show-translation');
            lockBar.classList.add('unlocked');
            
            // åˆ‡æ¢ç•Œé¢ï¼šéšè—è¾“å…¥æ¡†ï¼Œæ˜¾ç¤ºå…³é—­æŒ‰é’®
            inputArea.style.display = 'none';
            controlArea.style.display = 'flex';
            
            // æ¸…ç©ºå¯†ç æ¡†ï¼ˆå®‰å…¨èµ·è§ï¼‰
            input.value = "";
            
            alert("âœ… ç¿»è¯‘å·²æ˜¾ç¤ºï¼");
        } else {
            alert("âŒ å¯†ç é”™è¯¯");
            input.value = "";
        }
    }

    function lock() {
        const lockBar = document.getElementById('lockBar');
        const app = document.getElementById('mainApp');
        const inputArea = document.getElementById('inputArea');
        const controlArea = document.getElementById('controlArea');

        // å…³é—­ç¿»è¯‘
        app.classList.remove('show-translation');
        lockBar.classList.remove('unlocked');

        // åˆ‡æ¢ç•Œé¢ï¼šéšè—å…³é—­æŒ‰é’®ï¼Œæ˜¾ç¤ºè¾“å…¥æ¡†
        controlArea.style.display = 'none';
        inputArea.style.display = 'flex';
        
        alert("ğŸ”’ ç¿»è¯‘å·²éšè—ã€‚");
    }

    // ================= éŸ³é¢‘é€»è¾‘ =================
    const listeningScripts = {
        1: "Question One. Listen and choose. This is Mr. Li. He works with my dad. He is my dad's colleague.",
        2: "Question Two. Listen and choose. My name is Tom Brown. My surname is Brown.",
        3: "Question Three. Listen and choose. My grandma loves me very much. I am her happy grandchild.",
        4: "Question Four. Listen and judge. Look at this photo. This is not a child. This is an adult. He is working in the office."
    };

    let currentUtterance = null;
    let currentListenBtn = null;

    function stopAudio() {
        if (window.speechSynthesis) {
            window.speechSynthesis.cancel();
        }
        document.querySelectorAll('.listen-btn').forEach(btn => {
            btn.innerHTML = "â–¶";
            btn.classList.remove('playing');
        });
        currentListenBtn = null;
    }

    function speak(text, onStart, onEnd) {
        stopAudio();
        if ('speechSynthesis' in window) {
            const u = new SpeechSynthesisUtterance(text);
            u.lang = 'en-GB';
            u.rate = parseFloat(document.getElementById('rate').value);
            u.onstart = onStart;
            u.onend = onEnd;
            u.onerror = () => stopAudio();
            window.speechSynthesis.speak(u);
        } else {
            alert("æµè§ˆå™¨ä¸æ”¯æŒè¯­éŸ³");
        }
    }

    function playFullText(elementId) {
        const el = document.getElementById(elementId);
        const text = el.innerText || el.textContent;
        speak(text, null, null);
    }

    function playListen(id, btn) {
        if (window.speechSynthesis.speaking && currentListenBtn === btn) {
            stopAudio();
            return;
        }
        speak(
            listeningScripts[id],
            () => { 
                btn.innerHTML = "â– ";
                btn.classList.add('playing');
                currentListenBtn = btn;
            },
            () => { stopAudio(); }
        );
    }

    window.onbeforeunload = stopAudio;

</script>

</body>
</html>